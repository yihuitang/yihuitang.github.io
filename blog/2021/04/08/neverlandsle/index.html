<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/video.js/dist/video-js.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@videojs/themes@1/dist/fantasy/index.css">
<script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lettering.js/0.6.1/jquery.lettering.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/video.js/dist/video.min.js"></script>
<script src="/script/settheme.js"></script><title data-react-helmet="true">NeverlandBeats | CodeLab</title><meta data-react-helmet="true" property="og:title" content="NeverlandBeats | CodeLab"><meta data-react-helmet="true" name="description" content="Let&#x27;s track the beat!"><meta data-react-helmet="true" property="og:description" content="Let&#x27;s track the beat!"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/styles.84b1147b.css">
<link rel="preload" href="/styles.71fb8b2a.js" as="script">
<link rel="preload" href="/runtime~main.676e3002.js" as="script">
<link rel="preload" href="/main.aad9f3c1.js" as="script">
<link rel="preload" href="/1.af123087.js" as="script">
<link rel="preload" href="/2.2944d33e.js" as="script">
<link rel="preload" href="/3.ffbe02f2.js" as="script">
<link rel="preload" href="/ccc49370.9d6295d9.js" as="script">
<link rel="preload" href="/4e694028.8ae87c6f.js" as="script">
</head>
<body>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="My Site Logo"></a><a href="https://create.codelab.club" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">创作平台</a><a class="navbar__item navbar__link" href="/projects">玩给你看</a><a href="https://create.codelab.club/ideas#course" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">课程</a><a href="https://adapter.codelab.club/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">文档</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">博客</a><a class="navbar__item navbar__link" href="/blog/2020/09/25/about-codelab-2020">关于我们</a><a href="https://github.com/CodeLabClub" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a></div><div class="navbar__items navbar__items--right"></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="My Site Logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://create.codelab.club" target="_blank" rel="noopener noreferrer" class="menu__link">创作平台</a></li><li class="menu__list-item"><a class="menu__link" href="/projects">玩给你看</a></li><li class="menu__list-item"><a href="https://create.codelab.club/ideas#course" target="_blank" rel="noopener noreferrer" class="menu__link">课程</a></li><li class="menu__list-item"><a href="https://adapter.codelab.club/" target="_blank" rel="noopener noreferrer" class="menu__link">文档</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">博客</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/2020/09/25/about-codelab-2020">关于我们</a></li><li class="menu__list-item"><a href="https://github.com/CodeLabClub" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--8 col--offset-2"><article><header><h1 class="margin-bottom--sm blogPostTitle_kDB-">NeverlandBeats</h1><div class="margin-vert--md"><time datetime="2021-04-08T00:00:00.000Z" class="blogPostDate_2HVl">2021年4月8日   · 2 min 阅读时长</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="lets-track-the-beat"></a><strong>Let&#x27;s track the beat!</strong><a aria-hidden="true" tabindex="-1" class="hash-link" href="#lets-track-the-beat" title="Direct link to heading">#</a></h2><p>上一篇文档中已经提过，目前所有工作都源自最开始想要通过声音和视觉（包括平面和灯光）为空间渲染气氛这一简单想法，使用 Python、CodeLab Adapter 和 Scratch 做一些交互。出于对音乐节奏的个人偏好与兴趣，所以当下最关心的问题是实时节拍分析及应用，以下呈现的 Demo 是已做的一些尝试供与大家讨论交流之用。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="demo-0-最初的尝试"></a><strong>Demo 0: 最初的尝试</strong><a aria-hidden="true" tabindex="-1" class="hash-link" href="#demo-0-最初的尝试" title="Direct link to heading">#</a></h3><p><img src="/img/01light.png" alt="01 消息 1"></p><p><img src="/img/01light2.png" alt="01 消息 2"></p><p><img src="/img/neonscreen.png" alt="CodeLab Neon Screen"></p><p>以上三个项目关于编码与拼写，前两个受<a href="https://book.douban.com/subject/4822685/" target="_blank" rel="noopener noreferrer">《编码》</a>这本书的影响，利用灯泡的明灭对应 1 和 0，进而通过 8 个灯泡的明灭表达 26 个英文字母，由此可以来发送消息，如 CodeLab（可以区分大小写）。<a href="https://create.codelab.club/projects/4676/" target="_blank" rel="noopener noreferrer">第一个项目</a>是展示性的，<a href="https://create.codelab.club/projects/4674/" target="_blank" rel="noopener noreferrer">第二个项目</a>是交互性的，可以拖拽字母到中间发送区域，如果接入房间内的智能灯泡，就可以用实物表达，就像《编码》最开始举的通过手电与邻居小朋友黑夜隔空交流的例子。</p><p>第三个项目（<a href="https://create.codelab.club/projects/5250/" target="_blank" rel="noopener noreferrer">CodeLab Neon Screen</a>）以类似荧光屏与像素风格的效果动态呈现用户输入的英文单词，借助 Adapter 可以支持区分字母大小写以及基本的标点符号，当时也有试过通过 NetworkZero 插件实现单词在两个 Scratch 舞台上的接续打印。</p><br><video width="80%" src="https://adapter.codelab.club/video/1608519188336306.mp4" controls=""></video><p>音乐来自 How Did I Get Here by ODESZA</p><p>这个非常简单，只是利用 Scratch 与投影在房间内做了一点效果。</p><br><video width="80%" src="https://adapter.codelab.club/video/1608519188329664.mp4" controls=""></video><p>音乐来自 Soldier by Fleurie</p><video width="80%" src="https://adapter.codelab.club/video/1608024789501962.mp4" controls=""></video><p>音乐来自 Memories That You Call (feat.Monsoonsiren) by ODESZA &amp; Golden Features VIP Remix</p><p>以上两个视频所示的操作也非常简单，直接使用了 <a href="https://www.musicbeam.org/" target="_blank" rel="noopener noreferrer">MusicBeam</a> 这个基于 Processing 的软件。MusicBeam 使用投影仪投影做出了类似射灯的效果，视频中类似白色雪花或是移动的彩色横线等效果其实都是平面的。棒的是，这个软件会实时分析音乐节拍，使视觉效果与其呼应。我非常喜欢这个软件，后面一些工作也受了它的影响。</p><p>既然讲到了 MusicBeam，就把前期看到的其他几个项目在此也一并列出，他们的效果、风格、选用的音乐都很棒，所以想要参照他们在这个方向上做一些尝试，后面的部分工作也受了他们的影响。</p><br><p>有两个 web 项目，分别是 <a href="https://preziotte.com/partymode/" target="_blank" rel="noopener noreferrer">Party-mode by Mathew Preziotte</a>，如下方视频所示，作者设计了数种不同样式（抽象几何图形风格）、不同配色的音频视效，应用内有作者的默认歌单，也支持网络曲库或本机麦克风音频。</p><video width="80%" src="/img/partymode.MP4" controls=""></video><p>音乐是 Forgot About Me by Mononome</p><p>以及 <a href="https://rezmason.github.io/drivey/" target="_blank" rel="noopener noreferrer">Drivey by Rezmason</a>，如下图所示，项目主要是围绕驾驶的多种视觉效果（也配置了一个 Spotify 歌单），风格太赞，隧道、道路行驶应该也是计算机图形学中的基本项目，想在 Scratch 中学做，官方社区里也已有很多很棒的项目。</p><p><img src="/img/drivey.png" alt="drivey"></p><br><p>最后还有一款 VR 节奏游戏，叫做 <a href="https://store.steampowered.com/app/620980/Beat_Saber/" target="_blank" rel="noopener noreferrer">Beat Saber</a>，游戏没有玩过，感兴趣的是音乐节拍分析在体感游戏中的应用。因为游戏官方曲库内的歌曲数量有限，玩家社区就自己做了很多 song mapper，其中就涉及音乐信息提取与分析，可以参看以下两篇教程：</p><p><a href="https://towardsdatascience.com/introduction-to-music-information-retrieval-with-librosa-and-beat-saber-48daedb8653e" target="_blank" rel="noopener noreferrer">Introduction to music information retrieval with LibROSA and Beat Saber</a></p><p><a href="https://medium.com/swlh/beatmapsynth-an-automatic-song-mapper-for-beat-saber-aa9e59f093f8" target="_blank" rel="noopener noreferrer">BeatMapSynth: An automatic song mapper for Beat Saber</a></p><p><img src="/img/beatsaber.JPG" alt="beatsaber"></p><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="demo-1-neverland-bigbang"></a><strong>Demo 1: Neverland BigBang</strong><a aria-hidden="true" tabindex="-1" class="hash-link" href="#demo-1-neverland-bigbang" title="Direct link to heading">#</a></h3><video width="80%" src="https://adapter.codelab.club/video/eb22d4aeaf623afe259f30bd1aaefd.MP4" controls=""></video><p>音乐来自 Your Love Will Set You Free by Caribou</p><p>视频中所做的事：使用 Python <a href="http://pydub.com/" target="_blank" rel="noopener noreferrer">Pydub</a> 库切割已下载到本地的某音乐，然后使用 <a href="https://librosa.org/" target="_blank" rel="noopener noreferrer">Librosa</a> 库离线分析音乐片段的节拍，拿到该段音乐的 BPM 值（beats per minute）以及 beats 时间序列（具体操作可参考<a href="https://musicinformationretrieval.com/beat_tracking.html">这里</a>），然后分别使用 Python 控制房间内的智能彩灯、使用 Scratch 播放本地音乐及制作平面视觉内容，通过 CodeLab Adapter Linda 实现 Python 与 Scratch 的联动。因视频中可见的智能彩灯不能追上节拍的时间序列快速闪动，所以使用其内置的 Disco 模式，按照该段音乐的 BPM 闪烁。在 Scratch 中，图形的变化可以精准踩在节拍的时间序列上，即所见的彩色关键词与烟花效果的出现。视频对应的 Scratch 项目在<a href="https://create.codelab.club/projects/9088/" target="_blank" rel="noopener noreferrer">这里</a>，切割音乐、离线分析节拍以及控制彩灯的 Python 部分代码如有需要还需再整理。</p><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="demo-2-关于响度"></a><strong>Demo 2: 关于响度</strong><a aria-hidden="true" tabindex="-1" class="hash-link" href="#demo-2-关于响度" title="Direct link to heading">#</a></h3><p>Scratch 自带监测声音响度的积木，如果选用，火狐浏览器就会自动弹出麦克风选择窗口（chrome 浏览器没找到这个功能），其实就是选择音源输入设备，基于此做了如下小项目。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="21-使用-scratch-画笔动态绘制音频声波图"></a>2.1 使用 Scratch 画笔动态绘制音频声波图<a aria-hidden="true" tabindex="-1" class="hash-link" href="#21-使用-scratch-画笔动态绘制音频声波图" title="Direct link to heading">#</a></h4><p>Scratch 项目<a href="https://create.codelab.club/projects/9086/" target="_blank" rel="noopener noreferrer">在此</a></p><p><img src="/img/soundwave.png" alt="soundwave"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="22-用声音点亮灯光"></a>2.2 用声音点亮灯光<a aria-hidden="true" tabindex="-1" class="hash-link" href="#22-用声音点亮灯光" title="Direct link to heading">#</a></h4><p>如果选择电脑的内置麦克风，就可以监测环境中的声音，如果同时接入了智能灯光设备，就可以用灯光色彩或明暗的变化来反应空间内声音响度的变化。下面这个项目就是年前在英荔汇景空间活动时使用的开场项目，通过鼓掌制造声音，逐渐调亮空间内智能灯的明度，同时 Scratch 舞台上人物的数量也逐渐曾加，项目<a href="https://create.codelab.club/projects/9087/" target="_blank" rel="noopener noreferrer">见此</a>。</p><p><img src="/img/lightsup.png" alt="声音点亮灯光"></p><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="demo-3：-neverland-声音盒子与播放器"></a><strong>Demo 3： Neverland 声音盒子与播放器</strong><a aria-hidden="true" tabindex="-1" class="hash-link" href="#demo-3：-neverland-声音盒子与播放器" title="Direct link to heading">#</a></h3><video width="80%" src="/img/soundbox.MP4" controls=""></video><p>音乐是 Forgot About Me by Mononome；new dawn. by Sirch；Start Shootin&#x27;(Little People&#x27;s Americana remix) by Little People</p><p>这也是年前围绕声音的响度做的一个小项目，用到了两个 Scratch 项目，项目之间通过 Adapter Python 插件互发消息。左侧声音盒子项目负责存储和播放音乐以及控制音量大小，右侧声音播放器项目负责呈现控制按钮（播放/停止、下/上一首、音量增大/减小等）以及视觉效果。当时之所以分两个 Scratch  项目是因为不能在一个项目中同时实现播放音乐和侦测音乐的响度（意味着 Scratch 不支持 full-duplex？）。如果接入雷达，可以利用投影把右侧声音播放器项目投射在地面上，配合音乐呈现各种视觉效果的同时，用脚踩按钮来控制各项功能。如右下角灯泡图标所示，还能接入空间内的智能彩灯（如射灯等）来营造更为整体的效果。记得年前也在汇景空间接入雷达实验过，是可行的。现在回头看很多部分还是做得简单粗糙的，特别是视觉效果，接下来可以根据当前的进展再做优化。</p><p>声音播放器项目<a href="https://create.codelab.club/projects/9100/" target="_blank" rel="noopener noreferrer">在此</a>，声音盒子项目<a href="https://create.codelab.club/projects/9099/" target="_blank" rel="noopener noreferrer">在此</a>。</p><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="demo-4：流动绘制音频频谱"></a><strong>Demo 4：流动绘制音频频谱</strong><a aria-hidden="true" tabindex="-1" class="hash-link" href="#demo-4：流动绘制音频频谱" title="Direct link to heading">#</a></h3><video width="80%" src="/img/intro.MP4" controls=""></video><p>音乐来自 Intro by The xx</p><video width="80%" src="/img/spectrogram_girl.MP4" controls=""></video><p>音乐来自 Girl by Jamie xx</p><p>这两个项目都是使用 Python 对音频做实时分析，通过 Adapter EIM 将结果同步给 Scratch，然后在 Scratch 内实时绘图，<a href="https://codelab.club/blog/2021/03/30/livespectrogram" target="_blank" rel="noopener noreferrer">前一篇文档</a>还有<a href="https://github.com/CodeLabClub/NeverlandBeats" target="_blank" rel="noopener noreferrer">仓库主页</a>都有详细说明，这里不再重复。</p><br><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="demo-5：drop-the-beat"></a><strong>Demo 5：Drop the beat!</strong><a aria-hidden="true" tabindex="-1" class="hash-link" href="#demo-5：drop-the-beat" title="Direct link to heading">#</a></h3><video width="80%" src="/img/dropthebeats.MP4" controls=""></video><p>音乐来自 Sleep Sound by Jamie xx</p><p>基于 Python <a href="https://madmom.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">Madmom</a> 库对音乐做实时节拍分析，通过 Adapter EIM 将结果同步给 Scratch，画面中背景颜色的变化以及灰色小球的下落映射节拍时间序列。<a href="https://delu.medium.com/when-marbles-falling-onto-piano-keys-happen-to-play-music-af7c9d0934a6" target="_blank" rel="noopener noreferrer">向这个项目（When Marbles Falling onto Piano Keys Happen to Play Music）学习</a>，使用 <a href="https://create.codelab.club/" target="_blank" rel="noopener noreferrer">CodeLab Scratch</a> 内置 Box2D 插件，模拟小球的自由落体与碰撞。</p><p>这个项目还需优化，先放出来供与大家讨论交流之用。目前发现的问题：节拍分析代码还需调试；在 Scratch 中生成大量克隆体并同时使用 Box2D 时，可能会明显卡顿，使用 AddOn 内的一些配置也不能解决；颜色变化需要优化；使用 <a href="https://www.maartenbaert.be/simplescreenrecorder/" target="_blank" rel="noopener noreferrer">SimpleScreenRecorder</a> 录屏时好像也会对 Scratch 有影响，会有一点延迟？</p></section><footer class="row margin-vert--lg"><div class="col"><strong>标签：</strong><a class="margin-horiz--sm" href="/blog/tags/neverland">Neverland</a></div></footer></article><div><a href="https://github.com/CodeLabClub/NewCodeLabWeb/tree/master/blog/neverlandsle.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2021/04/09/4.7-release"><div class="pagination-nav__sublabel">上一篇</div><div class="pagination-nav__label">« 发布 CodeLab Adapter 4.7</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2021/03/30/livespectrogram"><div class="pagination-nav__sublabel">下一篇</div><div class="pagination-nav__label">使用 Python、Adapter EIM 与 Scratch 绘制流动的音乐频谱 »</div></a></div></nav></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="http://discuss.codelab.club/" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="http://discuss.codelab.club/">CodeLab 论坛</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/2021/07/21/CodeLab-handbook">手册</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/2020/08/20/tools">下载</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/2020/04/01/欢迎关注CodeLab微信公众号">微信公众号</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://www.zhihu.com/people/codelab-83" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://www.zhihu.com/people/codelab-83">在知乎</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://space.bilibili.com/607249092" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://space.bilibili.com/607249092">在B站</a></li></ul></div></div><div class="text--center"><div>Copyright © 2022 CodeLab&nbsp&nbsp&nbsp<a style="color:white" target="_blank" href="https://beian.miit.gov.cn/">粤ICP备2021005905号-1</a><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?3be250eb38d350c4a750c4b0bbfe513e";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></div></div></div></footer></div>
<script src="/styles.71fb8b2a.js"></script>
<script src="/runtime~main.676e3002.js"></script>
<script src="/main.aad9f3c1.js"></script>
<script src="/1.af123087.js"></script>
<script src="/2.2944d33e.js"></script>
<script src="/3.ffbe02f2.js"></script>
<script src="/ccc49370.9d6295d9.js"></script>
<script src="/4e694028.8ae87c6f.js"></script>
</body>
</html>