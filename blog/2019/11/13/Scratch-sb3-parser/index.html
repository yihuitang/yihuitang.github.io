<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/video.js/dist/video-js.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@videojs/themes@1/dist/fantasy/index.css">
<script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lettering.js/0.6.1/jquery.lettering.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/video.js/dist/video.min.js"></script>
<script src="/script/settheme.js"></script><title data-react-helmet="true">Scratch项目解析器 | CodeLab</title><meta data-react-helmet="true" property="og:title" content="Scratch项目解析器 | CodeLab"><meta data-react-helmet="true" name="description" content="Scratch增强计划"><meta data-react-helmet="true" property="og:description" content="Scratch增强计划"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/styles.84b1147b.css">
<link rel="preload" href="/styles.71fb8b2a.js" as="script">
<link rel="preload" href="/runtime~main.676e3002.js" as="script">
<link rel="preload" href="/main.aad9f3c1.js" as="script">
<link rel="preload" href="/1.af123087.js" as="script">
<link rel="preload" href="/2.2944d33e.js" as="script">
<link rel="preload" href="/3.ffbe02f2.js" as="script">
<link rel="preload" href="/ccc49370.9d6295d9.js" as="script">
<link rel="preload" href="/1b4e6c3c.d35c6471.js" as="script">
</head>
<body>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="My Site Logo"></a><a href="https://create.codelab.club" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">创作平台</a><a class="navbar__item navbar__link" href="/projects">玩给你看</a><a href="https://create.codelab.club/ideas#course" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">课程</a><a href="https://adapter.codelab.club/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">文档</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">博客</a><a class="navbar__item navbar__link" href="/blog/2020/09/25/about-codelab-2020">关于我们</a><a href="https://github.com/CodeLabClub" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a></div><div class="navbar__items navbar__items--right"></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="My Site Logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://create.codelab.club" target="_blank" rel="noopener noreferrer" class="menu__link">创作平台</a></li><li class="menu__list-item"><a class="menu__link" href="/projects">玩给你看</a></li><li class="menu__list-item"><a href="https://create.codelab.club/ideas#course" target="_blank" rel="noopener noreferrer" class="menu__link">课程</a></li><li class="menu__list-item"><a href="https://adapter.codelab.club/" target="_blank" rel="noopener noreferrer" class="menu__link">文档</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">博客</a></li><li class="menu__list-item"><a class="menu__link" href="/blog/2020/09/25/about-codelab-2020">关于我们</a></li><li class="menu__list-item"><a href="https://github.com/CodeLabClub" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--8 col--offset-2"><article><header><h1 class="margin-bottom--sm blogPostTitle_kDB-">Scratch项目解析器</h1><div class="margin-vert--md"><time datetime="2019-11-13T00:00:00.000Z" class="blogPostDate_2HVl">2019年11月13日   · 1 min 阅读时长</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><img class="img-responsive" src="/img/scratch_sb3_Pong_Starter_python.png"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="scratch增强计划"></a>Scratch增强计划<a aria-hidden="true" tabindex="-1" class="hash-link" href="#scratch增强计划" title="Direct link to heading">#</a></h1><p>此前在<a href="https://blog.just4fun.site/post/%E5%B0%91%E5%84%BF%E7%BC%96%E7%A8%8B/enhance-scratch3/" target="_blank" rel="noopener noreferrer">Scratch增强计划</a>中提到:</p><blockquote><p> 由于需要解析sb3文件，所以会顺手打造一些通用的小工具...简单写了一个脚本, 允许用户解压sb3文件，本地编辑之后，再重新生成sb3，之后在scratch3.0编辑器中依然能加载它. 这有什么用呢？还挺有用的，比如说我目前的一个用例: 之前保存的一些sb3项目在新的scratch3.0编辑器中打不开了(可能是新的平台不存在旧的extension)，我通过移除sb3中对应的extension block就可以重新加载项目...脚本源码和使用方法在这里:<a href="https://gist.github.com/wwj718/cd2447e68409a0f36141f4d1d7698fd9" target="_blank" rel="noopener noreferrer">sb3_compress.py</a></p></blockquote><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="解析scratch项目"></a>解析Scratch项目<a aria-hidden="true" tabindex="-1" class="hash-link" href="#解析scratch项目" title="Direct link to heading">#</a></h1><p>要实现<a href="https://blog.just4fun.site/post/%E5%B0%91%E5%84%BF%E7%BC%96%E7%A8%8B/enhance-scratch3/" target="_blank" rel="noopener noreferrer">Scratch增强计划</a>提到的计划，对Scratch项目的解析是基础工作，而解析工作的基础又是以理解Scratch项目的结构为基础，我在前文里提到</p><blockquote><p> 我希望让新的vm(Virtual Machine)能够解释运行sb3文件。sb3文件结构的设计是很优秀的,我在<a href="https://blog.just4fun.site/Scratch3_project_json_analysis_6.html">Scratch3技术分析之项目内部数据(第6篇）</a>做了阐述。</p></blockquote><p>原本准备使用<a href="https://pharo.org/" target="_blank" rel="noopener noreferrer">Pharo(Smalltalk)</a>来做实现它，Pharo中有一些工具很适合做此项工作(<a href="https://github.com/moosetechnology/PetitParser" target="_blank" rel="noopener noreferrer">PetitParser</a>、<a href="https://github.com/svenvc/NeoJSON" target="_blank" rel="noopener noreferrer">NeoJSON</a>、<a href="https://moosetechnology.org/" target="_blank" rel="noopener noreferrer">Moose</a>、<a href="https://gtoolkit.com/" target="_blank" rel="noopener noreferrer">Glamorous Toolkit</a>)</p><p>但近来事情特多，刚参加完Maker Faire，下个月还准备与国家图书馆一起做一个活动。就暂时鸽了这件事。</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="社区同伴"></a>社区同伴<a aria-hidden="true" tabindex="-1" class="hash-link" href="#社区同伴" title="Direct link to heading">#</a></h1><p>Scratch Team很早就发布了一个项目叫<a href="https://github.com/LLK/scratch-parser" target="_blank" rel="noopener noreferrer">scratch-parser</a>，目标是也是解析Scratch项目，后来似乎也鸽了。</p><p>今天偶然发现<a href="https://github.com/apple502j" target="_blank" rel="noopener noreferrer">apple502j</a>在这块做了不少工作:<a href="https://github.com/apple502j/sb3" target="_blank" rel="noopener noreferrer">apple502j/sb3</a>, 于是我准备在<a href="https://github.com/apple502j" target="_blank" rel="noopener noreferrer">apple502j</a>上前进，之后有时间再迁移到Pharo(我看中Pharo在数据分析上的便利性，当然，Python/Jupyter也很不错)，换一门语言是很快的，解析的业务代码却是耗时的，可喜的是，apple502j已经为我们做了很多辛苦的工作。</p><p><a href="https://github.com/apple502j" target="_blank" rel="noopener noreferrer">apple502j</a>是个Scratcher, Ta在Scratch社区的账号是<a href="https://scratch.mit.edu/users/apple502j/" target="_blank" rel="noopener noreferrer">apple502j</a>, apple502j除了活跃于Scratch社区，在github上也积极帮助scratch团队和社区开发者解决问题。</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="项目一览"></a>项目一览<a aria-hidden="true" tabindex="-1" class="hash-link" href="#项目一览" title="Direct link to heading">#</a></h1><p>我们来简单看看<a href="https://github.com/apple502j/sb3" target="_blank" rel="noopener noreferrer">apple502j/sb3</a>项目。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="安装"></a>安装<a aria-hidden="true" tabindex="-1" class="hash-link" href="#安装" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#ffffff;background-color:#000"><div class="token-line" style="color:#ffffff"><span class="token plain">pip3 </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> sb3</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="使用"></a>使用<a aria-hidden="true" tabindex="-1" class="hash-link" href="#使用" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="彩蛋"></a>彩蛋<a aria-hidden="true" tabindex="-1" class="hash-link" href="#彩蛋" title="Direct link to heading">#</a></h3><p>sb3如何使用呢?</p><p><a href="https://github.com/apple502j" target="_blank" rel="noopener noreferrer">apple502j</a>在使用说明里调皮了一下:</p><blockquote><p> All people, cats and other cute animals with Python 3.6 or above can use this library. If you are not cute but want to use this, try sb3.cute().</p></blockquote><p>你需要足够可爱才能使用它，如果你不够可爱怎么办呢？好说，试着运行一下<code>sb3.cute()</code></p><p>很有scratcher精神！</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="正式使用"></a>正式使用<a aria-hidden="true" tabindex="-1" class="hash-link" href="#正式使用" title="Direct link to heading">#</a></h3><p>我们对<a href="https://adapter.codelab.club/sb3/Pong_Starter.sb3">Pong_Starter.sb3</a>进行一些测试, 你可以在<a href="https://scratch3v3.codelab.club/?sb3url=https://adapter.codelab.club/sb3/Pong_Starter.sb3">CodeLab Scratch打开它</a>。</p><p><img src="/img/scratch_Pong_Starter.png"></p><p>让我们在Jupyter中对项目做一些探索:</p><p><img src="/img/scratch_sb3_Pong_Starter_python.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="分析有插件的项目"></a>分析有插件的项目<a aria-hidden="true" tabindex="-1" class="hash-link" href="#分析有插件的项目" title="Direct link to heading">#</a></h2><p>接下来让我们来分析一个带有CodeLab自定义插件的项目:</p><p><a href="https://scratch3v3.codelab.club/?sb3url=https://adapter.codelab.club/sb3/microbit_%E4%B9%90%E5%99%A8.sb3">microbit_乐器.sb3</a></p><img src="/img/sb3_python_extensions.png" width="600"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="前进"></a>前进<a aria-hidden="true" tabindex="-1" class="hash-link" href="#前进" title="Direct link to heading">#</a></h1><p>有了这个基础项目，我们未来的数据可视化工作以及评估用户的计算思维(computational thinking)会容易许多。</p><blockquote><p> 做新的解释器过程中，我们需要深入到scratch程序的所有细节里，这就逼着我们做出类似静态分析器的东西，我们自然会理解用户用到的所有程序元素，我们可以据此评估他在程序中展现的计算思维(computational thinking)。评估的教育框架会采用Scratch之父(Mitchel Resnick)早年的论文。  -- <a href="https://blog.just4fun.site/post/%E5%B0%91%E5%84%BF%E7%BC%96%E7%A8%8B/enhance-scratch3/" target="_blank" rel="noopener noreferrer">Scratch增强计划</a></p></blockquote><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="参考"></a>参考<a aria-hidden="true" tabindex="-1" class="hash-link" href="#参考" title="Direct link to heading">#</a></h1><ul><li><a href="https://github.com/apple502j/sb3" target="_blank" rel="noopener noreferrer">apple502j/sb3</a></li><li><a href="https://phosphorus.github.io/" target="_blank" rel="noopener noreferrer">phosphorus</a>:runs your Scratch projects really fast by compiling them to JavaScript.</li><li><a href="https://sheeptester.github.io/words-go-here/htmlifier/" target="_blank" rel="noopener noreferrer">htmlifier</a>:packages your Scratch project into a single HTML file</li><li><a href="https://github.com/LLK/scratch-parser" target="_blank" rel="noopener noreferrer">scratch-parser</a></li><li><a href="https://github.com/LLK/scratch-analysis" target="_blank" rel="noopener noreferrer">scratch-analysis</a>:Analysis tool for summarizing the structure, composition, and complexity of Scratch programs.</li><li><a href="https://scratch.mit.edu/users/apple502j/" target="_blank" rel="noopener noreferrer">apple502j</a></li></ul></section><footer class="row margin-vert--lg"><div class="col"><strong>标签：</strong><a class="margin-horiz--sm" href="/blog/tags/技术文档">技术文档</a><a class="margin-horiz--sm" href="/blog/tags/编程学习">编程学习</a><a class="margin-horiz--sm" href="/blog/tags/python">Python</a></div></footer></article><div><a href="https://github.com/CodeLabClub/NewCodeLabWeb/tree/master/blog/Scratch-sb3-parser.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2019/11/16/microbit-adapter"><div class="pagination-nav__sublabel">上一篇</div><div class="pagination-nav__label">« CodeLab Adapter 深度连接 micro:bit 生态</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2019/11/13/Scratch增强计划"><div class="pagination-nav__sublabel">下一篇</div><div class="pagination-nav__label">Scratch增强计划 »</div></a></div></nav></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="http://discuss.codelab.club/" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="http://discuss.codelab.club/">CodeLab 论坛</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/2021/07/21/CodeLab-handbook">手册</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/2020/08/20/tools">下载</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/2020/04/01/欢迎关注CodeLab微信公众号">微信公众号</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://www.zhihu.com/people/codelab-83" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://www.zhihu.com/people/codelab-83">在知乎</a></li></ul></div><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://space.bilibili.com/607249092" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://space.bilibili.com/607249092">在B站</a></li></ul></div></div><div class="text--center"><div>Copyright © 2022 CodeLab&nbsp&nbsp&nbsp<a style="color:white" target="_blank" href="https://beian.miit.gov.cn/">粤ICP备2021005905号-1</a><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?3be250eb38d350c4a750c4b0bbfe513e";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></div></div></div></footer></div>
<script src="/styles.71fb8b2a.js"></script>
<script src="/runtime~main.676e3002.js"></script>
<script src="/main.aad9f3c1.js"></script>
<script src="/1.af123087.js"></script>
<script src="/2.2944d33e.js"></script>
<script src="/3.ffbe02f2.js"></script>
<script src="/ccc49370.9d6295d9.js"></script>
<script src="/1b4e6c3c.d35c6471.js"></script>
</body>
</html>